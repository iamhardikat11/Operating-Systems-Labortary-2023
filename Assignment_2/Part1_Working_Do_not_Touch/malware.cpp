// // Steps to Write Malware Test Files
// // Create a Process P(Main)
// // Spawn 5 child processes
// // each of them spawn 10 processes each
// // and then these process run a while(1) {loop}
// #include <iostream>
// #include <unistd.h>
// using namespace std;
// int main()
// {
//     // Process P
//     while(1) {
//         sleep(120);
        
//     }
//     return 0;
// }

#include <iostream>
#include <unistd.h>
#include <sys/types.h>
#include <vector>

using namespace std;

int main()
{
// Sleep for 2 minutes
// sleep(120);
// Spawn 5 processes
vector<pid_t> pids;
for(int i = 0; i < 5; i++)
{
    pid_t pid = fork();
    if(pid == 0)
    {
        // Child process
        // Spawn 10 processes
        for(int j = 0; j < 10; j++)
        {
            pid_t pid = fork();
            if(pid == 0)
            {
                // Run an infinite loop
                while(true)
                {
                    // Do nothing
                }
            }
        }
        // Go to sleep
        sleep(120);
    }
    else
    {
        // Parent process
        pids.push_back(pid);
    }
}

for(auto it: pids) cout << it << " ";
cout << endl;
// Go to sleep
sleep(120);

return 0;
}